

# Практическая работа: Основы Docker (Локальный запуск)

## Цель работы
Научиться управлять Docker-контейнерами через терминал на своем компьютере: запускать, останавливать, собирать образы и понимать разницу между Image и Container.

## Задание
Выполнить последовательность команд в терминале, наблюдая за изменениями состояния Docker.

> **Важно:** Убедитесь, что Docker Desktop установлен и запущен.
> Проверка: в терминале выполните `docker --version`. Если версия отобразилась — можно начинать.


---

## Шаг 1: Работа с образами (Images)

### [ ] 1.1 Посмотрите список локальных образов
```bash
docker images
```
**Что это:** Показывает образы, которые уже скачаны на ваш компьютер  
**Зачем нужно:** Чтобы понимать, что уже есть, и не качать лишнее  
**Пример вывода:** Пусто (если вы впервые запустили Docker)

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Убедитесь, что список пуст или содержит базовые образы

### [ ] 1.2 Скачайте образ Alpine Linux
```bash
docker pull alpine:latest
```
**Что это:** Загрузка образа из Docker Hub (публичный реестр)  
**Зачем нужно:** Alpine — минималистичный Linux (~5 МБ), идеален для тестов  
**Пример:** `docker pull ubuntu:20.04` — скачает конкретную версию Ubuntu

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Снова выполните `docker images`
- [ ] Убедитесь, что `alpine` появился в списке

---

Не бесите меня, работайте

## Шаг 2: Запуск контейнеров (Run & Ps)

### [ ] 2.1 Запустите простой контейнер
```bash
docker run alpine echo "Hello from Docker!"
```
**Что это:** Создание и запуск контейнера из образа `alpine`  
**Зачем нужно:** `run` создает контейнер, выполняет команду и останавливается  
**Пример:** `docker run ubuntu date` — запустит и покажет дату

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Убедитесь, что в терминале вывелось "Hello from Docker!"

### [ ] 2.2 Проверьте список контейнеров
```bash
docker ps
```
**Что это:** Показывает **только запущенные** контейнеры  
**Зачем нужно:** Чтобы видеть, что сейчас работает  
**Пример вывода:** Пусто (наш контейнер уже завершил работу)

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Убедитесь, что список пуст (контейнер завершился сразу после `echo`)

### [ ] 2.3 Посмотрите все контейнеры (включая остановленные)
```bash
docker ps -a
```
**Что это:** Показывает **все** контейнеры: running, exited, created  
**Зачем нужно:** Чтобы найти и управлять завершёнными контейнерами  
**Пример:** В списке должен быть контейнер со статусом `Exited (0)`

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Найдите в списке контейнер с образом `alpine`
- [ ] Запомните его `CONTAINER ID` (первые 4 символа достаточно)

---

## Шаг 3: Управление жизненным циклом (Stop, Start, Rm)

### [ ] 3.1 Запустите контейнер в фоновом режиме
```bash
docker run -d --name test-container alpine sleep 100
```
**Что это:** `-d` (detached) запускает контейнер в фоне, `--name` задаёт имя  
**Зачем нужно:** Чтобы контейнер работал, а терминал оставался свободным  
**Пример:** `docker run -d nginx` — запустит веб-сервер в фоне

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Выполните `docker ps` — контейнер `test-container` должен быть в списке со статусом `Up`

### [ ] 3.2 Остановите контейнер
```bash
docker stop test-container
```
**Что это:** Корректная остановка контейнера по имени  
**Зачем нужно:** Чтобы завершить работу приложения внутри  
**Пример:** `docker stop <CONTAINER_ID>` — можно останавливать по ID

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Выполните `docker ps` — контейнера в списке быть не должно
- [ ] Выполните `docker ps -a` — контейнер должен быть со статусом `Exited`

### [ ] 3.3 Запустите остановленный контейнер заново
```bash
docker start test-container
```
**Что это:** Запуск ранее созданного и остановленного контейнера  
**Зачем нужно:** Чтобы возобновить работу без пересоздания  
**Пример:** После `start` контейнер продолжит выполнение команды

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Выполните `docker ps` — контейнер снова в статусе `Up`

### [ ] 3.4 Удалите контейнер
```bash
docker rm test-container
```
**Что это:** Удаление метаданных остановленного контейнера  
**Зачем нужно:** Чтобы не накапливать «мусор» на диске  
**Пример:** `docker rm -f <name>` — принудительное удаление работающего

**Проверка понимания:**
- [ ] Сначала выполните `docker stop test-container` (если он ещё работает)
- [ ] Затем выполните `docker rm test-container`
- [ ] Выполните `docker ps -a` — контейнера больше нет в списке
- [ ] Дата моего ухода с IThub - 14.05.26
---

## Шаг 4: Сборка своего образа (Build & Dockerfile)

### [ ] 4.1 Создайте файл Dockerfile
- [ ] Создайте папку `docker-lab` на компьютере
- [ ] Внутри создайте файл `Dockerfile` (без расширения!)
- [ ] Вставьте содержимое:

```dockerfile
FROM alpine:latest

# Выполняется при сборке образа
RUN echo "Build stage: file created" > /build.log

# Выполняется при запуске контейнера
CMD ["sh", "-c", "echo 'Runtime: Hello!' && cat /build.log"]
```

**Что это:** Инструкция для создания вашего образа  
**Зачем нужно:** `RUN` — подготовка окружения, `CMD` — запуск приложения  
**Пример:** `RUN npm install` (сборка), `CMD ["node", "app.js"]` (запуск)

**Проверка понимания:**
- [ ] Сохраните файл
- [ ] Убедитесь, что он называется точно `Dockerfile` (не `Dockerfile.txt`)

### [ ] 4.2 Соберите образ локально
```bash
cd docker-lab
docker build -t my-first-app .
```
**Что это:** Сборка образа из Dockerfile в текущей папке  
**Зачем нужно:** `-t my-first-app` задаёт тег (имя) для удобства  
**Пример:** `docker build -t app:v1 .` — имя + версия

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Дождитесь завершения (последняя строка: `Successfully tagged my-first-app:latest`)
- [ ] Выполните `docker images` — образ `my-first-app` должен быть в списке

### [ ] 4.3 Запустите свой образ
```bash
docker run --rm my-first-app
```
**Что это:** Запуск контейнера из вашего образа  
**Зачем нужно:** `--rm` автоматически удалит контейнер после завершения  
**Пример вывода:**
```text
Runtime: Hello!
Build stage: file created
```

**Проверка понимания:**
- [ ] Выполните команду
- [ ] Убедитесь, что вывелись обе строки (из `CMD` и из `RUN`)
- [ ] Выполните `docker ps -a` — контейнера нет (удалён благодаря `--rm`)

---

## Шаг 5: Практика (Самостоятельное задание)

### [ ] 5.1 Создайте свой Dockerfile
Напишите `Dockerfile`, который:
- [ ] Использует базовый образ `alpine:latest`
- [ ] Создаёт файл `/info.txt` с текстом "Student work" командой `RUN`
- [ ] При запуске выводит содержимое `/info.txt` и текущую дату командой `CMD`

### [ ] 5.2 Соберите и протестируйте локально
- [ ] Соберите образ с именем `student-task`
- [ ] Запустите контейнер и убедитесь, что вывод корректный
- [ ] Запустите контейнер дважды — убедитесь, что каждый раз это новый экземпляр

### [ ] 5.3 Отработайте управление
- [ ] Запустите контейнер в фоне с долгой командой (`sleep 200`)
- [ ] Проверьте, что он в статусе `Up` через `docker ps`
- [ ] Остановите его через `docker stop`
- [ ] Удалите через `docker rm`
- [ ] Убедитесь через `docker ps -a`, что контейнер удалён

---

## Контрольные вопросы

### [ ] 6.1 Простые вопросы
- [ ] В чем разница между `docker pull` и `docker build`?
- [ ] Что показывает `docker ps` без флага `-a`?
- [ ] Зачем нужен флаг `--rm` при запуске?

### [ ] 6.2 Понимание различий
- [ ] В чем разница между `RUN` и `CMD` в Dockerfile?
- [ ] Что произойдет, если выполнить `docker run` без `--rm` много раз?
- [ ] Как запустить контейнер, чтобы он не блокировал терминал?

### [ ] 6.3 Практические задания
- [ ] Попробуйте выполнить `docker stop` на контейнер, который уже завершился — что будет?
- [ ] Попробуйте удалить работающий контейнер без `-f` — какая ошибка?
- [ ] Добавьте в Dockerfile вторую команду `RUN` и посмотрите, как меняются слои при сборке

---

## Сроки выполнения
- [ ] Начало: [дата]
- [ ] Сдача: [дата]

---

## Советы
- [ ] Всегда давайте контейнерам имена через `--name` — так легче управлять
- [ ] Используйте `--rm` для тестовых запусков, чтобы не засорять систему
- [ ] Если команда «висит» — возможно, контейнер ждёт ввода, нажмите `Ctrl+C`
- [ ] Логи запуска можно посмотреть через `docker logs <container_name>`

---

## Что вы должны понять
После этой работы вы должны:
- [ ] Понимать разницу между образом (Image) и контейнером (Container)
- [ ] Уметь скачивать, собирать и запускать образы локально
- [ ] Знать основные команды управления: `ps`, `stop`, `start`, `rm`
- [ ] Понимать разницу между `RUN` (сборка) и `CMD` (запуск) в Dockerfile
- [ ] Уметь очищать среду после экспериментов

---

> **Домашнее задание на следующую пару:**  
> Когда все команды выше будут понятны, мы перенесём этот же процесс в GitHub Actions.  
> Подумайте: какая команда в workflow будет соответствовать `docker build`, а какая — `docker run`?
---

